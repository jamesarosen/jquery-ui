<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>jQuery UI Menu - iOS-Style Demo</title>
	<link type="text/css" href="../../themes/base/jquery.ui.all.css" rel="stylesheet" />
	<script src="../../jquery-1.5.1.js"></script>
	<script src="../../ui/jquery.ui.core.js"></script>
	<script src="../../ui/jquery.ui.position.js"></script>
	<script src="../../ui/jquery.ui.widget.js"></script>
	<script src="../../ui/jquery.ui.menu.js"></script>
	<link type="text/css" href="../demos.css" rel="stylesheet" />
	<script type="text/javascript">
		$.widget( "ui.iosMenu", {
			options: {
				backText:      'Back',
				slideDuration: 400,
				slideEasing:   'linear'
			},

			_insertBackButtons: function() {
				this.element.find( 'li ul, li ol' ).prepend(
					$( '<li>' +
						 '	<span class="ui-icon ui-icon-carat-1-w"></span>' +
						 '	<a href="#menu-back" class="ios-menu-back-link">' +
									this.options.backText +
						 '	</a>' +
						 '</li>'
				) );
				return this;
			},

			_create: function( options ) {
				var iosMenu = this;

				iosMenu
					._insertBackButtons()
					.element
						.addClass( 'ios-style' )
						.menu({
							// When a submenu shows up, place it just to the right
							// of the current menu. Later, we'll slide it into view.
							position: {
								my: 'left top',
								at: 'right top',
								of: iosMenu.element
							}
						});

				var menu = iosMenu.element.data( 'menu' );

				// Override menu#select to account for nesting and back buttons:
				menu.select = function( event ) {
					if ( menu.active && menu.active.find( '> .ios-menu-back-link' ).length ) {
						// if you selected "back", go back:
						menu.focus( event, menu.active );
						if ( menu.left( event ) ) {
							event.stopImmediatePropagation();
						}
						event.preventDefault();
					} else if ( menu.active && menu.active.find( '> ul' ).length ) {
						// if you selected something with children, show the children:
						menu.focus( event, menu.active );
						if ( menu.right( event ) ) {
							event.stopImmediatePropagation();
						}
						event.preventDefault();
					} else {
						menu._trigger( 'select', event, { item: menu.active } );
					}
				};

				// Override menu#left to enable sliding behavior:
				menu.left = function( event ) {
					var newItem = this.active && this.active.parents( 'li:not(.ui-menubar-item) ').first(),
							self		= this,
							parent;
					if ( newItem && newItem.length ) {
					  newItem.find( '> a' ).addClass( 'ui-state-focus' ).removeClass( 'ui-state-active' );
						parent = this.active.parent();
						parent
							.attr( 'aria-hidden', 'true' )
							.attr( 'aria-expanded', 'false' )
							.animate({
								left: self.element.css( 'width' )
							}, iosMenu.options.slideDuration, iosMenu.options.slideEasing, function() {
								parent.hide();
								self.focus( event, newItem );
							})
						return true;
					} else if ( event && event.which === $.ui.keyCode.ESCAPE ) {
						// #left gets called both for left-arrow and escape. If it's the
						// latter and we're at the top, fire a "close" event:
						self._trigger( 'close', event );
					}
				};

				// Override menu#_open to enable sliding behavior:
				var menuOpenWithoutSliding = menu._open;
				menu._open = function ( submenu ) {
					menuOpenWithoutSliding.call( this, submenu );
					submenu.animate({
						left: 0
					}, iosMenu.options.slideDuration, iosMenu.options.slideEasing);
				};

				// Override menu#_startOpening so that hovering doesn't
				// initiate the sliding:
				menu._startOpening = function() {
					clearTimeout( this.timer );
				}
			},

			destroy: function() {
			  var menu = this.element && this.element.data( 'menu' );
				menu && menu.destroy();
			}
		});

		$(function() {
			var list    = $( '#breakfast-menu' );
			var firstLI = list.find( 'li' ).first();
			list
				.iosMenu()
				.focus()
				.menu( 'focus', {}, firstLI )
				.bind( 'menuselect', function( event, ui ) {
					$('#log').append( '<li>' + $(ui.item).text() + '</li>' );
				});
		});
	</script>
	<style>
		.ios-style, .ios-style ul, .ios-style ol { background: #fff; height: 200px; padding: 2px; width: 260px; }
		.ios-style { overflow-x: hidden; overflow-y: auto; }
		.ios-style::-webkit-scrollbar { width: 5px; height: 5px; }
		.ios-style::-webkit-scrollbar-thumb { background: rgba(128, 128, 128, 0.6); border-radius: 4px; }
		.ios-style ul, .ios-style ol { overflow-y: visible; border: none; }
		.ios-style.ui-menu-icons .ui-menu-item a { position: inherit; }
		.ios-style .ui-menu-item a { cursor: pointer; outline: none; }
	</style>
</head>
<body>

<div>
	<ul id='breakfast-menu'>
		<li>
			<a>Eggs</a>
			<ul>
				<li><a>Two eggs and toast</a></li>
				<li><a>Two eggs, meat, and toast</a></li>
				<li>
					<a>Omelettes</a>
					<ul>
						<li><a>Western</a></li>
						<li><a>Mushroom</a></li>
					</ul>
				</li>
			</ul>
		</li>
		<li>
			<a>Sweets</a>
			<ul>
				<li><a>Belgian waffle</a></li>
				<li><a>French toast</a></li>
				<li><a>Pigs in blankets</a></li>
			</ul>
		</li>
		<li>
			<a>Sides</a>
			<ul>
				<li><a>Seasonal fruit</a></li>
				<li><a>Yogurt w/ fruit</a></li>
				<li><a>Sausages</a></li>
				<li><a>Bacon</a></li>
				<li><a>English muffin</a></li>
				<li><a>Croissant</a></li>
				<li><a>Bagel</a></li>
				<li><a>Bagel w/ cream cheese</a></li>
				<li><a>Toast</a></li>
				<li><a>Home fries</a></li>
			</ul>
		</li>
	</ul>
	<ol id="log"></ol>

</div><!-- End demo -->

<div class="demo-description">

<p>
	An iOS-Style menu: Use the mouse or cursor keys to navigate through the
	menu. Click on an item or press enter to select it.
</p>

</div><!-- End demo-description -->



</body>
</html>
